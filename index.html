<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Political Spectrum (Fixed)</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;900&display=swap" rel="stylesheet">

    <!-- =================================================================
         1. CSS 樣式表 (如果您要分開檔案，請將此區塊存為 style.css)
         ================================================================= -->
    <style>
        :root {
            /* 基礎色調 */
            --bg-color: #050505;
            --panel-bg: #0f0f0f;
            --text-main: #e0e0e0;
            --grid-line: #222;
            
            /* 陣營色 (高亮螢光版 - 確保在黑底上看得到) */
            --p-kmt: #00b0ff;   /* 亮藍 */
            --p-dpp: #00e676;   /* 螢光綠 */
            --p-tpp: #ffea00;   /* 亮黃 */
            --p-red: #ff1744;   /* 螢光紅 */
            --p-ind: #bdbdbd;   /* 亮灰 */
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* 背景網格 (亮一點) */
        .bg-grid {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: 0;
            opacity: 0.6;
        }

        /* 頂部 Header */
        header {
            height: 50px;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            background: rgba(5,5,5,0.95);
            z-index: 100;
        }

        .brand {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 900;
            font-size: 1.1rem;
            color: #fff;
            letter-spacing: -1px;
        }

        /* 主畫面分割 */
        .main-interface {
            display: flex;
            flex: 1;
            height: calc(100vh - 50px);
            z-index: 10;
        }

        /* 左側：操作與視覺區 */
        .viz-zone {
            flex: 3; /* 佔 75% */
            position: relative;
            border-right: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .control-bar {
            padding: 10px 20px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid #333;
            background: rgba(10,10,10,0.9);
            align-items: center;
        }

        .btn-mode {
            background: #111;
            border: 1px solid #444;
            color: #888;
            padding: 6px 14px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn-mode:hover, .btn-mode.active {
            background: #fff;
            color: #000;
            border-color: #fff;
            font-weight: 700;
        }

        .sub-nav-scroll {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            margin-left: 10px;
        }
        .sub-pill {
            font-size: 0.75rem;
            padding: 4px 10px;
            border: 1px solid #333;
            color: #888;
            cursor: pointer;
            white-space: nowrap;
            border-radius: 4px;
        }
        .sub-pill:hover, .sub-pill.active { border-color: #888; color: #fff; background: #222; }

        /* 軌道區塊 */
        .track-container {
            flex: 1;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5%;
        }

        /* 光譜軸線 (紅>藍>綠) */
        .axis-line {
            width: 100%;
            height: 6px; 
            position: relative;
            border-radius: 3px;
            background: linear-gradient(90deg, 
                var(--p-red) 0%, 
                var(--p-kmt) 45%, 
                var(--p-kmt) 55%, 
                var(--p-dpp) 100%);
            box-shadow: 0 0 20px rgba(0,0,0,0.6);
            z-index: 5;
        }

        .axis-label {
            position: absolute;
            top: -25px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        .label-left { left: 0; color: var(--p-red); }
        .label-mid { left: 50%; transform: translateX(-50%); color: #fff; text-shadow: 0 0 5px #000;}
        .label-right { right: 0; color: var(--p-dpp); }

        /* 節點定位容器 (絕對定位在軌道上) */
        .node-group {
            position: absolute;
            top: 50%;
            width: 1px;
            height: 0; /* 高度為0，往上下延伸 */
            display: flex;
            justify-content: center;
            /* 讓節點顯示在軸線上方 */
            z-index: 20; 
        }

        /* 連接線 (更亮) */
        .connector {
            position: absolute;
            width: 1px;
            background: #fff;
            box-shadow: 0 0 4px #fff; /* 發光效果 */
            z-index: 10;
            opacity: 0.8;
        }

        /* 頭像按鈕 */
        .avatar-node {
            position: absolute;
            width: 38px; height: 38px;
            border-radius: 50%;
            background-color: #222; /* 預設深色底 */
            border: 2px solid #fff;
            cursor: pointer;
            z-index: 30; /* 最高層級，確保可點擊 */
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.8);
            
            /* 文字居中 (當沒有圖片時) */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: #fff;
            overflow: hidden; /* 切掉超出的圖片 */
        }

        .avatar-node img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none; /* 預設隱藏，載入成功後 JS 開啟 */
        }

        .avatar-node:hover {
            transform: scale(1.4);
            z-index: 100;
            border-color: #fff !important;
            box-shadow: 0 0 15px rgba(255,255,255,0.6);
        }

        .avatar-node.active {
            z-index: 99;
            transform: scale(1.2);
            box-shadow: 0 0 0 4px rgba(255,255,255,0.2);
        }

        /* 黨籍邊框色 */
        .b-kmt { border-color: var(--p-kmt); color: var(--p-kmt); }
        .b-dpp { border-color: var(--p-dpp); color: var(--p-dpp); }
        .b-tpp { border-color: var(--p-tpp); color: var(--p-tpp); }
        .b-red { border-color: var(--p-red); color: var(--p-red); }
        .b-ind { border-color: var(--p-ind); color: var(--p-ind); }

        /* 右側：資訊面板 */
        .info-zone {
            flex: 1;
            background: var(--panel-bg);
            border-left: 1px solid #333;
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 50;
        }

        .char-name { font-size: 2rem; font-weight: 900; margin: 0; color: #fff; }
        .meta-tag {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            padding: 3px 8px;
            background: #111;
            color: #fff;
            border: 1px solid #444;
            display: inline-block;
        }
        .score-val { font-family: 'JetBrains Mono', monospace; font-size: 3rem; font-weight: 700; color: #fff; }
        .analysis-block { color: #aaa; font-size: 0.9rem; line-height: 1.6; }

        @media (max-width: 768px) {
            .main-interface { flex-direction: column; overflow: auto; }
            .viz-zone { height: 50vh; border-right: none; border-bottom: 1px solid #333; }
        }
    </style>
</head>
<body>

<!-- =================================================================
     2. HTML 結構區
     ================================================================= -->
<div class="bg-grid"></div>

<header>
    <div class="brand">2026_SPECTRUM_V3</div>
</header>

<div class="main-interface">
    <!-- 左側視覺區 -->
    <div class="viz-zone">
        <div class="control-bar">
            <button class="btn-mode active" onclick="switchMode('mayor', this)">縣市長</button>
            <button class="btn-mode" onclick="switchMode('legislator', this)">立委大亂鬥</button>
            <div class="sub-nav-scroll" id="subNav"></div>
        </div>

        <div class="track-container">
            <div class="axis-line">
                <span class="axis-label label-left">親中 (RED)</span>
                <span class="axis-label label-mid">中華民國 (BLUE)</span>
                <span class="axis-label label-right">台灣本土 (GREEN)</span>
            </div>
            <!-- 節點層 -->
            <div id="nodesLayer" style="position: absolute; width: 90%; height: 100%; top:0; left:5%; pointer-events:none;">
                <!-- 節點由 JS 動態產生 -->
            </div>
        </div>
    </div>

    <!-- 右側資訊區 -->
    <div class="info-zone" id="infoPanel">
        <div>
            <h1 class="char-name" id="pName">SELECT UNIT</h1>
            <div style="margin-top:10px;">
                <span class="meta-tag" id="pParty">---</span>
                <span class="meta-tag" id="pTitle">---</span>
            </div>
        </div>
        <div>
            <div style="font-size:0.7rem; color:#666; margin-bottom:5px;">POLITICAL INDEX</div>
            <div class="score-val" id="pScore">--</div>
        </div>
        <div>
            <div style="font-size:0.7rem; color:#666; margin-bottom:5px;">ANALYSIS</div>
            <p class="analysis-block" id="pAnalysis">
                請點擊左側軌道上的人物按鈕查看詳細資料。
            </p>
        </div>
    </div>
</div>

<!-- =================================================================
     3. JavaScript 邏輯區 (如果您要分開檔案，請將此區塊存為 script.js)
     ================================================================= -->
<script>
    // 圖片連結 (使用相對穩定的新聞或公開圖源)
    const imgDb = {
        "蔣萬安": "https://img.ltn.com.tw/Upload/news/600/2022/11/10/phpM3XwTz.jpg",
        "王世堅": "https://img.ltn.com.tw/Upload/news/600/2023/06/15/phpJv5yqG.jpg",
        "吳思瑤": "https://img.ltn.com.tw/Upload/news/600/2024/02/26/php8e3vDa.jpg",
        "李四川": "https://img.ltn.com.tw/Upload/news/600/2023/06/22/php5qGq4a.jpg",
        "蘇巧慧": "https://img.ltn.com.tw/Upload/news/600/2023/04/19/php8x3yZ2.jpg",
        "洪孟楷": "https://img.ltn.com.tw/Upload/news/600/2023/05/17/php0s7a4d.jpg",
        "黃國昌": "https://img.ltn.com.tw/Upload/news/600/2023/11/16/phpQ5r4aA.jpg",
        "韓國瑜": "https://img.ltn.com.tw/Upload/news/600/2024/02/01/php9w2e3r.jpg",
        "柯建銘": "https://img.ltn.com.tw/Upload/news/600/2024/01/15/php6t7y8u.jpg",
        "徐巧芯": "https://img.ltn.com.tw/Upload/news/600/2023/04/22/php2q3w4e.jpg",
        "沈伯洋": "https://img.ltn.com.tw/Upload/news/600/2023/11/15/php4r5t6y.jpg",
        "黃捷": "https://img.ltn.com.tw/Upload/news/600/2023/08/08/php7u8i9o.jpg",
        "謝龍介": "https://img.ltn.com.tw/Upload/news/600/2022/09/03/php1a2s3d.jpg",
        "高金素梅": "https://img.ltn.com.tw/Upload/news/600/2019/06/28/php8h7g6f.jpg",
        "傅崐萁": "https://img.ltn.com.tw/Upload/news/600/2024/01/22/php5d4f3g.jpg",
        "柯志恩": "https://img.ltn.com.tw/Upload/news/600/2022/07/11/php9j8k7l.jpg",
        "陳亭妃": "https://img.ltn.com.tw/Upload/news/600/2023/04/26/php3x2c1v.jpg",
        "林俊憲": "https://img.ltn.com.tw/Upload/news/600/2023/03/24/php6b5n4m.jpg",
        "王定宇": "https://img.ltn.com.tw/Upload/news/600/2021/03/18/php7m8k9l.jpg"
    };

    // 資料庫
    const db = {
        mayor: {
            "台北": [
                { name: "蔣萬安", party: "kmt", score: 42, title: "現任市長", analysis: "蔣家後代。藍營共主，維持官方交流但避開過度親中爭議。" },
                { name: "王世堅", party: "dpp", score: 82, title: "潛在挑戰者", analysis: "柯黑大將，反共立場極其鮮明。" },
                { name: "吳思瑤", party: "dpp", score: 88, title: "立委", analysis: "賴系嫡系，國會攻防主將，抗中立場強硬。" }
            ],
            "新北": [
                { name: "李四川", party: "kmt", score: 45, title: "副市長", analysis: "川伯。務實工程師形象，避談意識形態，位置中立。" },
                { name: "劉和然", party: "kmt", score: 44, title: "副市長", analysis: "侯友宜接班人，溫和本土藍。" },
                { name: "洪孟楷", party: "kmt", score: 38, title: "立委", analysis: "藍營新生代，強調九二共識精神。" },
                { name: "蘇巧慧", party: "dpp", score: 90, title: "立委", analysis: "蘇系大將，本土意識極強，反擊藍營論述主力。" },
                { name: "林右昌", party: "dpp", score: 85, title: "黨秘書長", analysis: "正國會龍頭，立場穩健。" }
            ],
            "台中": [
                { name: "江啟臣", party: "kmt", score: 48, title: "副院長", analysis: "藍營本土派/親美派代表，光譜接近中線。" },
                { name: "楊瓊瓔", party: "kmt", score: 38, title: "立委", analysis: "傳統地方派系，重視經貿紅利。" },
                { name: "何欣純", party: "dpp", score: 80, title: "立委", analysis: "全國最高票立委，標準台派。" },
                { name: "蔡其昌", party: "dpp", score: 82, title: "立委", analysis: "深耕台中，反中立場明確。" }
            ],
            "高雄": [
                { name: "柯志恩", party: "kmt", score: 46, title: "立委", analysis: "淡化統派色彩，主打民生與教育，走淺藍路線。" },
                { name: "賴瑞隆", party: "dpp", score: 88, title: "立委", analysis: "菊系，強調產業去紅色風險。" },
                { name: "許智傑", party: "dpp", score: 85, title: "立委", analysis: "鳳山小金剛，保台第一線。" }
            ]
        },
        legislator: {
            "30人大亂鬥": [
                { name: "高金素梅", party: "ind", score: 10, title: "立委", analysis: "長期親中，論述與北京高度一致。" },
                { name: "傅崐萁", party: "red", score: 15, title: "總召", analysis: "親中派領袖，積極推動兩岸融合。" },
                { name: "翁曉玲", party: "red", score: 18, title: "立委", analysis: "自稱中國人，統派立場鮮明。" },
                { name: "陳玉珍", party: "kmt", score: 20, title: "立委", analysis: "金門立委，主張金廈共同生活圈。" },
                { name: "馬文君", party: "kmt", score: 25, title: "立委", analysis: "阻擋潛艦國造，被質疑削弱國防。" },
                { name: "賴士葆", party: "kmt", score: 30, title: "立委", analysis: "資深藍營，堅守傳統九二共識。" },
                { name: "謝龍介", party: "kmt", score: 34, title: "立委", analysis: "台語戰神，主張和平交流。" },
                { name: "韓國瑜", party: "kmt", score: 35, title: "院長", analysis: "核心信仰偏向深藍，九二共識信徒。" },
                { name: "徐巧芯", party: "kmt", score: 36, title: "立委", analysis: "戰鬥藍，主攻弊案，懷疑抗中論述。" },
                { name: "王鴻薇", party: "kmt", score: 37, title: "立委", analysis: "揭弊優先，對中採守勢。" },
                { name: "羅智強", party: "kmt", score: 39, title: "立委", analysis: "強調對話取代對抗。" },
                { name: "林國成", party: "tpp", score: 40, title: "立委", analysis: "親民黨出身，兩岸一家親。" },
                { name: "張啓楷", party: "tpp", score: 42, title: "立委", analysis: "務實交流，關注民生。" },
                { name: "李彥秀", party: "kmt", score: 45, title: "立委", analysis: "港湖區，作風相對溫和。" },
                { name: "江啟臣", party: "kmt", score: 48, title: "副院長", analysis: "本土藍，親美路線。" },
                { name: "黃國昌", party: "tpp", score: 48, title: "總召", analysis: "實質藍移，停止批判中國。" },
                { name: "陳昭姿", party: "tpp", score: 55, title: "立委", analysis: "獨派出身入白營。" },
                { name: "黃珊珊", party: "tpp", score: 55, title: "立委", analysis: "保留部分台灣主體性。" },
                { name: "林岱樺", party: "dpp", score: 70, title: "立委", analysis: "務實台派，宗教背景。" },
                { name: "陳亭妃", party: "dpp", score: 78, title: "立委", analysis: "正國會成員，正常國家化。" },
                { name: "邱議瑩", party: "dpp", score: 80, title: "立委", analysis: "絕不低頭，反中立場明確。" },
                { name: "柯建銘", party: "dpp", score: 85, title: "總召", analysis: "立院老將，國會防線指揮官。" },
                { name: "林俊憲", party: "dpp", score: 92, title: "立委", analysis: "賴系嫡系，立場強硬。" },
                { name: "王定宇", party: "dpp", score: 92, title: "立委", analysis: "外交國防鷹派。" },
                { name: "黃捷", party: "dpp", score: 94, title: "立委", analysis: "年輕世代，進步獨派。" },
                { name: "范雲", party: "dpp", score: 95, title: "立委", analysis: "關注滲透，防範威權。" },
                { name: "沈伯洋", party: "dpp", score: 98, title: "立委", analysis: "黑熊學院，認知作戰專家。" }
            ]
        }
    };

    const nodesLayer = document.getElementById('nodesLayer');
    const subNav = document.getElementById('subNav');
    let currentMode = 'mayor';

    function switchMode(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.btn-mode').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderSubNav();
    }

    function renderSubNav() {
        subNav.innerHTML = '';
        const cats = Object.keys(db[currentMode]);
        cats.forEach((cat, idx) => {
            const pill = document.createElement('div');
            pill.className = `sub-pill ${idx===0?'active':''}`;
            pill.innerText = cat;
            pill.onclick = () => loadData(cat, pill);
            subNav.appendChild(pill);
        });
        if(cats.length > 0) loadData(cats[0], subNav.children[0]);
    }

    function loadData(cat, pill) {
        if(pill) {
            document.querySelectorAll('.sub-pill').forEach(p => p.classList.remove('active'));
            pill.classList.add('active');
        }
        nodesLayer.innerHTML = '';

        const people = db[currentMode][cat];
        const count = people.length;

        people.forEach((p, i) => {
            const group = document.createElement('div');
            group.className = 'node-group';
            group.style.left = `${p.score}%`;

            // 高度壓縮設定：每個人只錯開 30px
            let dist = 30 + (i % 5) * 30; 
            // 人多時 (如立委) 用 6 層錯位
            if (count > 15) dist = 25 + (i % 6) * 32;

            const isUp = i % 2 === 0;
            
            // 1. 連接線
            const line = document.createElement('div');
            line.className = 'connector';
            if (isUp) {
                line.style.bottom = '0';
                line.style.height = `${dist}px`;
            } else {
                line.style.top = '0';
                line.style.height = `${dist}px`;
            }
            group.appendChild(line);

            // 2. 頭像節點
            const node = document.createElement('div');
            // 決定顏色
            let borderClass = 'b-ind';
            if(p.party === 'kmt') borderClass = 'b-kmt';
            if(p.party === 'dpp') borderClass = 'b-dpp';
            if(p.party === 'tpp') borderClass = 'b-tpp';
            if(p.party === 'red') borderClass = 'b-red';
            
            node.className = `avatar-node ${borderClass}`;
            // 允許滑鼠事件 (pointer-events)
            node.style.pointerEvents = 'auto';

            if (isUp) {
                node.style.bottom = `${dist}px`;
                node.style.marginBottom = '-19px'; // 半徑微調
            } else {
                node.style.top = `${dist}px`;
                node.style.marginTop = '-19px';
            }

            // 處理圖片與文字
            const imgUrl = imgDb[p.name];
            
            // 預設顯示文字
            node.innerText = p.name.substring(0,1);

            if(imgUrl) {
                const img = document.createElement('img');
                img.src = imgUrl;
                // 圖片載入成功後才顯示，並清空文字
                img.onload = function() {
                    this.style.display = 'block';
                    node.innerText = ''; // 清空文字
                    node.appendChild(this);
                };
                // 載入失敗則什麼都不做，保持顯示文字
            }

            node.onclick = () => showInfo(p, node, borderClass);
            
            group.appendChild(node);
            nodesLayer.appendChild(group);
        });
    }

    function showInfo(data, nodeEl, borderClass) {
        document.querySelectorAll('.avatar-node').forEach(n => n.classList.remove('active'));
        nodeEl.classList.add('active');

        // 取得顏色
        const dummyEl = document.createElement('div');
        dummyEl.className = borderClass;
        document.body.appendChild(dummyEl);
        const color = getComputedStyle(dummyEl).borderColor;
        document.body.removeChild(dummyEl);

        document.getElementById('pName').innerText = data.name;
        document.getElementById('pName').style.color = color;
        
        document.getElementById('pParty').innerText = data.party.toUpperCase();
        document.getElementById('pParty').style.borderColor = color;
        document.getElementById('pParty').style.color = color;
        
        document.getElementById('pTitle').innerText = data.title;
        
        document.getElementById('pScore').innerText = data.score;
        document.getElementById('pScore').style.color = color;
        
        document.getElementById('pAnalysis').innerHTML = data.analysis;
    }

    // 啟動
    renderSubNav();

</script>
</body>
</html>
